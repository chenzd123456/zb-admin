# zb-admin 实战开发教程

## 1. 项目初始化

### 1.1 创建项目
```bash
npm create vite@latest zb-admin --template vue-ts
cd zb-admin
npm install
```

### 1.2 安装核心依赖
```bash
npm install vue-router@4 pinia axios element-plus
npm install sass --save-dev
```

### 1.3 基础目录结构
```
src/
├── api/        # API接口
├── assets/     # 静态资源
├── components/ # 公共组件
├── router/     # 路由配置
├── store/      # 状态管理
├── utils/      # 工具函数
└── views/      # 页面视图
```

## 2. 核心模块实现

### 2.1 路由系统实现

#### 2.1.1 创建路由实例
```typescript
// src/router/index.ts
import { createRouter, createWebHashHistory } from 'vue-router'

const router = createRouter({
  history: createWebHashHistory(),
  routes: [
    {
      path: '/',
      component: () => import('@/views/home/index.vue')
    }
  ]
})

export default router
```

#### 2.1.2 动态路由加载
```typescript
// 添加动态路由
function addRoutes(routes) {
  routes.forEach(route => {
    router.addRoute(route)
  })
}
```

### 2.2 权限系统实现

#### 2.2.1 权限验证方法
```typescript
// src/utils/permission.ts
export function hasPermission(roles: string[], route: RouteRecordRaw) {
  return !route.meta?.roles || roles.some(role => route.meta.roles.includes(role))
}
```

#### 2.2.2 路由过滤
```typescript
export function filterRoutes(routes: RouteRecordRaw[], roles: string[]) {
  return routes.filter(route => {
    if (hasPermission(roles, route)) {
      if (route.children) {
        route.children = filterRoutes(route.children, roles)
      }
      return true
    }
    return false
  })
}
```

### 2.3 组件开发

#### 2.3.1 创建SvgIcon组件
```vue
<!-- src/components/SvgIcon.vue -->
<template>
  <svg :class="svgClass">
    <use :xlink:href="`#icon-${iconClass}`" />
  </svg>
</template>

<script setup>
defineProps({
  iconClass: String,
  className: String
})

const svgClass = computed(() => {
  return ['svg-icon', className].filter(Boolean).join(' ')
})
</script>
```

## 3. 最佳实践

### 3.1 API封装
```typescript
// src/api/request.ts
const service = axios.create({
  baseURL: import.meta.env.VITE_API_BASE_URL,
  timeout: 10000
})

// 请求拦截器
service.interceptors.request.use(config => {
  config.headers.Authorization = `Bearer ${getToken()}`
  return config
})
```

### 3.2 状态管理
```typescript
// src/store/user.ts
export const useUserStore = defineStore('user', {
  state: () => ({
    token: '',
    userInfo: null
  }),
  actions: {
    async login(params) {
      const { data } = await loginApi(params)
      this.token = data.token
      this.userInfo = data.userInfo
    }
  }
})
```

## 4. 开发流程

1. **需求分析**：明确功能需求
2. **模块设计**：设计组件和API
3. **代码实现**：按模块开发
4. **单元测试**：保证代码质量
5. **集成测试**：验证功能完整性

## 5. 常见问题解决

### 5.1 动态路由刷新丢失
解决方案：在路由守卫中重新添加路由

### 5.2 权限校验失败
检查点：
1. 路由meta.roles配置
2. 用户角色获取
3. 路由过滤逻辑